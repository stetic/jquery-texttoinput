(function(a){a.fn.textToInput=function(b){b=b||{};return this.each(function(){var f=a.extend({},a.fn.textToInput.defaults,{},b),e=(f.contenteditable===true)&&"contentEditable" in document.documentElement;if(e){a(this).attr("contentEditable","true")}var g=a(this),d=function(k){if(e){c(a(this));l=a(this)}else{k.preventDefault();k.stopPropagation();var m=a(this).text(),j=a(this).html(),i='<input value="'+m+'" class="'+f.css_class+'">',l=a(this).html(i).find("input").first();a(this).data("default_html",j).unbind("click.texttoinput");c(l)}l.bind("blur.texttoinput",function(){a(this).unbind("blur.texttoinput");h(a(this));if(!e){a(this).parent().text(a(this).val()).bind("click.texttoinput",d)}});l.bind("keydown.texttoinput",function(n){if(n.which==13&&f.return_change===true){n.preventDefault();a(this).unbind("keydown.texttoinput");a(this).blur()}else{if(n.which==27){n.preventDefault();a(this).parent().html(a(this).parent().data("default_html"));a(this).unbind("blur.texttoinput").blur()}}});if(typeof(f.onFocus)=="function"){f.onFocus.apply(a(this)[0])
}},h=function(i){if(typeof(f.onChange)=="function"){if(e){i.val(i.text())}f.onChange.apply(i[0],arguments)}},c=function(l){if(f.select_text!==true){l.focus().val(l.val());return l}var m=document,i=window,j,k;l.focus();if(!e){l.select()}else{if(m.body.createTextRange){var j=m.body.createTextRange();j.moveToElementText(l[0]);j.select()}else{if(i.getSelection){var k=i.getSelection();var j=m.createRange();j.selectNodeContents(l[0]);k.removeAllRanges();k.addRange(j)}}}return l};a(this).bind("click.texttoinput",d)})};a.fn.textToInput.defaults={select_text:true,css_class:"",contenteditable:true,onFocus:null,onChange:null,return_change:true};a(function(){a(".texttoinput").textToInput()})})(jQuery);